<?php
/**
 * Test getTargetFriday function
 */

require_once __DIR__ . '/includes/date_helper.php';

echo "=== getTargetFriday() Test Cases ===\n";
echo "BNI週の定義: 金曜5:00 AM ~ 次の金曜5:00 AM\n\n";

$testCases = [
    // Friday cases (2025-12-19 is Friday)
    ['2025-12-19 04:59:00', '金曜日 4:59 AM', '2025-12-12'],
    ['2025-12-19 05:00:00', '金曜日 5:00 AM', '2025-12-19'],
    ['2025-12-19 12:00:00', '金曜日 12:00 PM', '2025-12-19'],
    ['2025-12-19 23:59:00', '金曜日 11:59 PM', '2025-12-19'],

    // Saturday (2025-12-13, 2025-12-20 is Saturday)
    ['2025-12-13 00:00:00', '土曜日 12:00 AM', '2025-12-19'],
    ['2025-12-13 12:00:00', '土曜日 12:00 PM', '2025-12-19'],
    ['2025-12-20 00:00:00', '土曜日 12:00 AM', '2025-12-26'],

    // Sunday (2025-12-14 is Sunday)
    ['2025-12-14 00:00:00', '日曜日 12:00 AM', '2025-12-19'],
    ['2025-12-14 12:00:00', '日曜日 12:00 PM', '2025-12-19'],

    // Monday - Thursday (2025-12-15 Mon ~ 2025-12-18 Thu)
    ['2025-12-15 12:00:00', '月曜日', '2025-12-19'],
    ['2025-12-16 12:00:00', '火曜日', '2025-12-19'],
    ['2025-12-17 12:00:00', '水曜日', '2025-12-19'],
    ['2025-12-18 12:00:00', '木曜日', '2025-12-19'],
    ['2025-12-18 23:59:00', '木曜日 23:59 PM', '2025-12-19'],

    // Next week Friday (2025-12-26 is Friday)
    ['2025-12-26 04:59:00', '次の金曜日 4:59 AM', '2025-12-19'],
    ['2025-12-26 05:00:00', '次の金曜日 5:00 AM', '2025-12-26'],
];

foreach ($testCases as $test) {
    $result = getTargetFriday($test[0]);
    $status = ($result === $test[2]) ? '✅' : '❌';
    echo sprintf("%s %s → %s (expected: %s)\n", $status, $test[1], $result, $test[2]);
}

echo "\n=== Current Test ===\n";
$now = date('Y-m-d H:i:s');
$today = getTargetFriday($now);
echo "現在時刻: {$now}\n";
echo "対象金曜日: {$today}\n";
