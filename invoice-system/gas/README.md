# GAS版 請求書・見積書システム（freee形式準拠）

## 概要

Google Apps Script + スプレッドシートで動作する請求書・見積書・納品書・領収書管理システムです。
freeeの形式に準拠し、見積書→納品書→請求書の変換、合算請求書作成に対応しています。

## 2つのバージョン

### 🌟 FULL_VERSION.gs（推奨）

**単一ファイルで全機能を実装したフルバージョン**

- ✅ 見積書・納品書・請求書・領収書の作成（リッチダイアログUI）
- ✅ 書類変換（見積書→納品書/請求書、納品書→請求書）
- ✅ 合算請求書作成（複数の見積書・納品書から）
- ✅ 複数明細の動的追加・削除
- ✅ リアルタイム金額計算（小計・消費税10%・合計）
- ✅ 取引先管理
- ✅ 初期セットアップ（シート自動作成）
- ❌ Gmail連携なし
- ❌ PDF自動生成なし

### 📦 分割ファイル版（開発者向け）

複数の.gsファイルと.htmlファイルに分割したバージョン。カスタマイズ時に便利。

## 特徴

- **サーバー不要**: Googleアカウントのみで運用可能
- **月額費用 0円**: Google無料枠内で運用
- **初期費用 3〜4万円**: PHP版より1〜2万円安い
- **freee形式準拠**: 見積書・納品書・請求書・領収書の4種類
- **書類変換**: 見積書→納品書/請求書、納品書→請求書
- **合算請求書**: 複数の見積書・納品書から1つの請求書を作成
- **印鑑対応**: 角印・丸印の画像アップロード（任意・設定シートにURL記載）

## セットアップ手順（FULL_VERSION.gs 推奨）

### 1. スプレッドシートを作成

1. 新しいGoogleスプレッドシートを作成
2. **シートは自動作成されるため、手動作成は不要です**

### 2. GASコードをデプロイ

1. スプレッドシートで「拡張機能」→「Apps Script」を開く
2. デフォルトの`コード.gs`を削除
3. **FULL_VERSION.gs の内容を全てコピー＆ペースト**
4. ファイル名を`コード.gs`のままにする（または好きな名前に変更）
5. 💾 保存（Ctrl+S / Cmd+S）

### 3. 初回セットアップを実行

1. スプレッドシートをリロード（F5 / Cmd+R）
2. カスタムメニュー「📄 請求書管理」が表示される
3. **「🔧 初期セットアップ（初回のみ）」をクリック**
4. 権限承認を求められたら承認
5. ✅ セットアップ完了メッセージが表示されたら成功！

### 4. 自社情報を入力

1. 「設定」シートを開く
2. B列に自社情報を入力：
   ```
   会社名、郵便番号、住所、電話番号、FAX番号、
   メールアドレス、登録番号（インボイス）、
   振込先銀行名、支店名、口座種別、口座番号、口座名義、
   印鑑画像URL（任意）
   ```

### 5. 取引先を登録

1. メニュー「📄 請求書管理」→「取引先を追加」をクリック
2. 取引先情報を入力して登録

---

## 分割ファイル版のセットアップ（開発者向け）

分割ファイル版を使用する場合は、以下の11個の.gsファイルと複数の.htmlファイルをApps Scriptエディタにコピーする必要があります：

- `Code.gs`, `Utils.gs`, `Quote.gs`, `Delivery.gs`, `Invoice.gs`,
- `Receipt.gs`, `Conversion.gs`, `Customer.gs`, `CombineInvoice.gs`,
- `PDF.gs`, `Mail.gs`, `CreateQuoteDialog.html` 等

**推奨**: 初めての方は **FULL_VERSION.gs** を使用してください。

## 使い方

### 見積書を作成

1. メニュー「見積書作成」をクリック
2. 取引先、発行日、件名、明細を入力
3. 「見積書を作成」ボタン → 見積書シートに追加

### 見積書 → 請求書に変換

1. メニュー「見積書 → 請求書に変換」をクリック
2. 見積書番号を選択
3. 支払期限を入力
4. 「変換」ボタン → 請求書シートに追加

### 合算請求書を作成

1. メニュー「合算請求書を作成」をクリック
2. 取引先を選択
3. 合算する見積書・納品書を選択（複数選択可）
4. 発行日・支払期限を設定
5. 「合算請求書を作成」ボタン → 1つの請求書にまとめる

## ディレクトリ構成

```
gas/
├── FULL_VERSION.gs          # 🌟 フルバージョン（単一ファイル、推奨）
├── ALL_IN_ONE.gs            # 簡易版（プロンプトUI）
├── MANUAL.html              # 使い方マニュアル
├── README.md                # このファイル
├──
├── （分割ファイル版）
├── Code.gs                  # メイン処理
├── Utils.gs                 # ユーティリティ関数
├── Quote.gs                 # 見積書処理
├── Delivery.gs              # 納品書処理
├── Invoice.gs               # 請求書処理
├── Receipt.gs               # 領収書処理
├── Conversion.gs            # 書類変換処理
├── Customer.gs              # 取引先管理
├── CombineInvoice.gs        # 合算請求書
└── CreateQuoteDialog.html   # 見積書作成UI
```

## GASの制限事項

- **実行時間上限**: 6分/実行（FULL_VERSION.gsでは問題なし）
- **推奨利用規模**: 月間100〜200件以下の書類発行
- **データ保存**: スプレッドシートに保存（最大500万セル）
- **同時アクセス**: 複数ユーザーの同時編集に対応

## よくある質問（FAQ）

### Q1. FULL_VERSION.gsとALL_IN_ONE.gsの違いは？

- **FULL_VERSION.gs**: リッチなダイアログUI、全機能実装（推奨）
- **ALL_IN_ONE.gs**: プロンプトベースのシンプルUI、基本機能のみ

### Q2. Gmail連携やPDF生成は使えますか？

FULL_VERSION.gsには含まれていません。必要な場合は別途カスタマイズが必要です（追加費用）。

### Q3. 印鑑画像はどうやってアップロードしますか？

1. Google DriveやImgurなどに印鑑画像をアップロード
2. 画像の公開URLを取得
3. 「設定」シートのB14セル（印鑑画像URL）に貼り付け

### Q4. データはどこに保存されますか？

全てGoogleスプレッドシートの各シートに保存されます。バックアップは自動保存されます。

### Q5. 複数人で使えますか？

はい、スプレッドシートの共有機能で複数人での利用が可能です。

## ライセンス

MIT License

## サポート

ご質問・カスタマイズ依頼は以下までお問い合わせください：
- Email: info@yojitu.com
- Web: https://www.yojitu.com
