# 自動保存ルール - ターミナルクラッシュ対策

**作成日**: 2025-12-11
**目的**: VSCodeターミナルがクラッシュしても作業内容を失わないようにする

---

## 📋 ルール概要

### 1. 定期的なMDファイル更新（重要度: ★★★★★）
- **頻度**: タスク完了ごと、または大きな作業の節目ごと
- **ファイル名**: `SESSION_STATUS_YYYY-MM-DD.md`
- **内容**:
  - 現在の日時
  - 完了したタスク
  - 進行中のタスク
  - 次のタスク
  - 重要な決定事項
  - 問題点・エラー

### 2. 小まめなGitコミット（重要度: ★★★★★）
- **頻度**: 小さな変更でもコミット
- **タイミング**:
  - 1つのファイル編集が完了した時
  - 1つの機能実装が完了した時
  - エラー修正が完了した時
  - 作業の区切りごと

### 3. TodoWrite の活用（重要度: ★★★★☆）
- **頻度**: タスク状態が変わるたび
- **更新内容**:
  - タスク完了時: status を "completed" に
  - 新しいタスク発見時: 追加
  - タスク不要時: 削除

---

## 📝 SESSION_STATUS ファイルのテンプレート

```markdown
# セッション状況 - YYYY-MM-DD HH:MM

**最終更新**: YYYY-MM-DD HH:MM:SS

## ✅ 完了したタスク
1. [HH:MM] タスク名 - 簡単な説明
2. [HH:MM] タスク名 - 簡単な説明

## 🔄 進行中のタスク
- **現在**: タスク名
- **進捗**: 50% / 何をしているか

## 📌 次のタスク
1. タスク名 - 優先度: 高
2. タスク名 - 優先度: 中

## 💡 重要な決定事項
- ユーザーの回答: ...
- 実装方針: ...

## ⚠️ 問題点・エラー
- 問題: ...
- 対処法: ...

## 📊 Git状況
- ブランチ: main
- 最新コミット: xxxxxxx
- 未コミット: 3 files

---
**次回セッション再開時**: このファイルを読んで、「進行中のタスク」から再開してください。
```

---

## 🔄 実施タイミング

### タイミング1: タスク完了時
```
1. TodoWrite でタスクを "completed" に更新
2. SESSION_STATUS ファイルを更新
3. git add + git commit（小さな変更でもOK）
```

### タイミング2: 大きな作業の区切り
```
1. SESSION_STATUS ファイルを更新
2. git commit -m "WIP: 作業内容"
3. TodoWrite を更新
```

### タイミング3: エラー発生時
```
1. SESSION_STATUS にエラー内容を記録
2. 対処法も記録
3. git commit -m "WIP: エラー対応中"
```

### タイミング4: ユーザーからの重要な指示
```
1. SESSION_STATUS に決定事項を記録
2. CLAUDE_CODE_RULES.md に追記（必要に応じて）
```

---

## 📂 ファイル命名規則

### セッション状況ファイル
- `SESSION_STATUS_2025-12-11.md` - その日の最新状況
- 1日1ファイル（上書き更新）
- 日付が変わったら新しいファイルを作成

### 作業ログファイル
- `WORK_LOG_2025-12-11.md` - 詳細な作業記録
- 1日1ファイル（追記）
- 完了した作業の詳細を記録

### インシデントレポート
- `INCIDENT_REPORT_2025-12-11.md` - 重大なエラー・問題
- 必要に応じて作成

---

## 🚀 自動保存フローの例

### 例1: リファーラル管理画面のエラー修正

1. **開始時**: SESSION_STATUS更新
   ```
   ## 🔄 進行中のタスク
   - **現在**: リファーラル管理画面のエラー修正
   - **進捗**: 0% / 問題調査中
   ```

2. **問題発見時**: SESSION_STATUS更新
   ```
   ## ⚠️ 問題点・エラー
   - 問題: referrals_weeklyテーブルが存在しない
   - 対処法: schema.sqlにテーブル定義を追加
   ```

3. **ファイル編集完了時**: git commit
   ```bash
   git add database/schema.sql
   git commit -m "Add: referrals_weeklyテーブル定義"
   ```

4. **タスク完了時**: TodoWrite + SESSION_STATUS更新 + git push
   ```
   ## ✅ 完了したタスク
   1. [14:30] リファーラル管理画面のエラー修正 - referrals_weeklyテーブル作成
   ```

---

## ⏰ 時間管理のヒント

### 集中作業時間の目安
- **15分**: 小さなタスク（ファイル1個の編集）
- **30分**: 中規模タスク（複数ファイルの編集）
- **60分**: 大規模タスク（新機能実装）

### 15分ごとの確認
- 進捗状況を確認
- SESSION_STATUSを更新するか判断
- 必要ならgit commit

---

## 🛡️ セーフガード

### ターミナルがクラッシュした場合の復旧手順

1. **SESSION_STATUS ファイルを確認**
   ```bash
   cat SESSION_STATUS_2025-12-11.md
   ```

2. **Git状況を確認**
   ```bash
   git status
   git log --oneline -5
   ```

3. **TodoList を確認**
   - Claude Codeを起動
   - 前回のTodoListが復元される

4. **未コミットの変更を確認**
   ```bash
   git diff
   ```

5. **作業を再開**
   - SESSION_STATUSの「進行中のタスク」から再開

---

**このルールに従って、必ず小まめに保存してください！**

**重要**: このファイルは `CLAUDE_CODE_RULES.md` と併せて、セッション開始時に必ず読むこと。
