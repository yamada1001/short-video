# 本番環境確認チェックリスト - 2025-12-11

**確認日時**: 2025-12-11
**確認者**: ユーザー
**対象環境**: https://yojitu.com/bni-slide-system/

---

## 📋 確認項目

### 1. リファーラル管理画面
**URL**: https://yojitu.com/bni-slide-system/admin/referrals.php

#### 確認ポイント
- [ ] ページが正しく表示される
- [ ] 週選択ドロップダウンが動作する
- [ ] リファーラル金額入力フォームが表示される
- [ ] メンバーごとに金額を入力できる
- [ ] 保存ボタンが機能する
- [ ] 保存後、データが正しく反映される
- [ ] エラーメッセージが適切に表示される

#### 想定される動作
1. ログイン後、管理者メニューから「リファーラル管理」を選択
2. 週を選択すると、その週のメンバー一覧が表示される
3. 各メンバーのリファーラル金額を入力
4. 「保存」をクリックすると、データベースに保存される
5. スライドに反映される

---

### 2. 座席表編集画面
**URL**: https://yojitu.com/bni-slide-system/admin/seating.php

#### 確認ポイント
- [ ] ページが正しく表示される
- [ ] 8つのテーブル（A〜H）が表示される
- [ ] 47名のメンバー情報が表示される
- [ ] ドラッグ&ドロップでメンバーを移動できる
- [ ] テーブル間でメンバーを移動できる
- [ ] 保存ボタンが機能する
- [ ] 保存後、data/seating_chart.json が更新される
- [ ] スライドに反映される

#### 想定される動作
1. ログイン後、管理者メニューから「座席表編集」を選択
2. 8つのテーブルとメンバー一覧が表示される
3. メンバーをドラッグして各テーブルに配置
4. 「保存」をクリックすると、JSONファイルに保存される
5. スライドの座席表スライドに反映される

---

### 3. スライド表示
**URL**: https://yojitu.com/bni-slide-system/admin/slide.php

#### 確認ポイント
- [ ] スライドが正しく表示される
- [ ] 全19フェーズのスライドが正しい順番で表示される
- [ ] リファーラル総額がスライドに表示される
- [ ] 座席表スライドが正しく表示される
- [ ] シェアストーリースライドが表示される（担当者がいる場合）
- [ ] エデュケーションスライドが表示される（担当者がいる場合）
- [ ] ピッチプレゼンスライドが表示される（担当者がいる場合）
- [ ] スライドのデザインが統一されている（BNIレッド #D00C24）
- [ ] アニメーションが正しく動作する

#### 想定される動作
1. ログイン後、管理者メニューから「スライド表示」を選択
2. 週を選択すると、その週のスライドが生成される
3. スライドショーが開始される
4. 各スライドが正しい順番で表示される

---

### 4. データベース確認
**データベースファイル**: `/home/yojitu/yojitu.com/public_html/bni-slide-system/data/bni_system.db`

#### 確認する内容

##### テーブル構造確認
```bash
# サーバーにSSH接続して確認
ssh yojitu@yojitu.com

# データベースに接続
sqlite3 /home/yojitu/yojitu.com/public_html/bni-slide-system/data/bni_system.db

# テーブル一覧を表示
.tables

# referrals_weeklyテーブルの構造確認
.schema referrals_weekly

# survey_dataテーブルの構造確認（新フィールド確認）
.schema survey_data
```

##### データ確認
```sql
-- referrals_weeklyテーブルのデータ確認
SELECT * FROM referrals_weekly ORDER BY week_date DESC LIMIT 10;

-- survey_dataテーブルの新フィールド確認
SELECT id, introducer_name, is_share_story, is_education_presenter, education_file_path, is_pitch_presenter, pitch_file_path
FROM survey_data
ORDER BY created_at DESC LIMIT 10;
```

#### 確認ポイント
- [ ] `referrals_weekly` テーブルが存在する
- [ ] `survey_data` テーブルに新フィールドが追加されている
  - [ ] `is_share_story` (INTEGER)
  - [ ] `is_education_presenter` (INTEGER)
  - [ ] `education_file_path` (TEXT)
- [ ] データが正しく保存されている
- [ ] 外部キー制約が正しく設定されている

---

## 🔍 詳細な確認手順

### Step 1: 管理者ログイン
1. https://yojitu.com/bni-slide-system/login.php にアクセス
2. 管理者アカウントでログイン
3. ダッシュボードが表示されることを確認

### Step 2: リファーラル管理画面の確認
1. 左メニューから「リファーラル管理」をクリック
2. 週選択ドロップダウンから最新の週を選択
3. メンバー一覧が表示されることを確認
4. テスト用に適当な金額を入力（例: 山田さん: 50000円）
5. 「保存」をクリック
6. 成功メッセージが表示されることを確認
7. ページをリロードして、入力した金額が保存されていることを確認

### Step 3: 座席表編集画面の確認
1. 左メニューから「座席表編集」をクリック
2. 8つのテーブル（A〜H）と47名のメンバーが表示されることを確認
3. メンバーをドラッグして別のテーブルに移動
4. 「保存」をクリック
5. 成功メッセージが表示されることを確認
6. ページをリロードして、配置が保存されていることを確認

### Step 4: スライド表示の確認
1. 左メニューから「スライド表示」をクリック
2. 週を選択
3. スライドが生成されることを確認
4. リファーラル総額スライドで、Step 2で入力した金額が反映されていることを確認
5. 座席表スライドで、Step 3で編集した配置が反映されていることを確認
6. 全スライドが正しく表示されることを確認

### Step 5: データベース確認
1. SSHでサーバーに接続
2. SQLiteデータベースを開く
3. テーブル構造を確認
4. データが正しく保存されているか確認

---

## ✅ 確認結果記入欄

### 1. リファーラル管理画面
**結果**: [ ] 正常 / [ ] 問題あり

**問題があった場合の詳細**:
```
（ここに問題の詳細を記入）
```

---

### 2. 座席表編集画面
**結果**: [ ] 正常 / [ ] 問題あり

**問題があった場合の詳細**:
```
（ここに問題の詳細を記入）
```

---

### 3. スライド表示
**結果**: [ ] 正常 / [ ] 問題あり

**問題があった場合の詳細**:
```
（ここに問題の詳細を記入）
```

---

### 4. データベース確認
**結果**: [ ] 正常 / [ ] 問題あり

**問題があった場合の詳細**:
```
（ここに問題の詳細を記入）
```

---

## 📝 総合評価

**全体の評価**: [ ] 全て正常 / [ ] 一部問題あり / [ ] 重大な問題あり

**次のアクション**:
- [ ] 問題なし → ビデオ対応実装に進む
- [ ] 問題あり → 問題の修正を優先

---

## 💡 トラブルシューティング

### よくある問題と対処法

#### 問題1: ページが表示されない（404エラー）
**原因**: ファイルがアップロードされていない
**対処法**:
```bash
# ローカルで確認
ls -la admin/referrals.php
ls -la admin/seating.php

# サーバーで確認
ssh yojitu@yojitu.com
ls -la /home/yojitu/yojitu.com/public_html/bni-slide-system/admin/
```

#### 問題2: データが保存されない
**原因**: データベースの書き込み権限がない
**対処法**:
```bash
# データベースファイルの権限確認
chmod 664 data/bni_system.db
chmod 775 data/
```

#### 問題3: ドラッグ&ドロップが動かない
**原因**: JavaScriptライブラリ（Sortable.js）が読み込まれていない
**対処法**: ブラウザの開発者ツールでコンソールエラーを確認

---

**確認完了後、この結果をClaude Codeに報告してください！**
