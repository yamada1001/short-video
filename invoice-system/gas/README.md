# GAS版 請求書・見積書システム（freee形式準拠）

## 概要

Google Apps Script + スプレッドシートで動作する請求書・見積書・納品書・領収書管理システムです。
freeeの形式に準拠し、見積書→納品書→請求書の変換、合算請求書作成、PDF自動生成、Gmail連携メール送信に対応しています。

## 特徴

- **サーバー不要**: Googleアカウントのみで運用可能
- **月額費用 0円**: Google無料枠内で運用
- **初期費用 3〜4万円**: PHP版より1〜2万円安い
- **freee形式準拠**: 見積書・納品書・請求書・領収書の4種類
- **書類変換**: 見積書→納品書/請求書、納品書→請求書
- **合算請求書**: 複数の見積書・納品書から1つの請求書を作成
- **PDF自動生成**: Google Docs → PDF変換
- **Gmail連携**: メール送信機能
- **印鑑対応**: 角印・丸印の画像アップロード（任意）

## セットアップ手順

### 1. スプレッドシートを作成

1. 新しいGoogleスプレッドシートを作成
2. 以下のシートを作成（シート名は正確に入力）：
   - `設定`
   - `取引先マスタ`
   - `見積書`
   - `納品書`
   - `請求書`
   - `領収書`
   - `品目マスタ`（任意）

### 2. シートのヘッダー行を設定

#### 設定シート
```
A列: 項目名 | B列: 値
────────────────────────
会社名
郵便番号
住所
電話番号
FAX番号
メールアドレス
登録番号（インボイス）
振込先銀行名
振込先支店名
振込先口座種別
振込先口座番号
振込先口座名義
印鑑画像URL
```

#### 取引先マスタシート
```
A: 取引先ID | B: 取引先名 | C: 郵便番号 | D: 住所 | E: 担当者名 | F: 電話番号 | G: メールアドレス | H: 備考 | I: 作成日 | J: 更新日
```

#### 見積書 / 納品書 / 請求書 / 領収書シート（共通）
```
A: 書類番号 | B: ステータス | C: 取引先ID | D: 取引先名 | E: 発行日 | F: 支払期限 | G: 件名 | H: 明細JSON | I: 小計 | J: 消費税 | K: 合計金額 | L: 備考 | M: 社内メモ | N: 変換元 | O: PDF URL | P: 作成日 | Q: 更新日
```

### 3. GASコードをデプロイ

1. スプレッドシートで「拡張機能」→「Apps Script」を開く
2. 以下のファイルをコピー＆ペースト：
   - `Code.gs`
   - `Utils.gs`
   - `Quote.gs`
   - `Delivery.gs`
   - `Invoice.gs`
   - `Receipt.gs`
   - `Conversion.gs`
   - `Customer.gs`
   - `CombineInvoice.gs`
   - `PDF.gs`
   - `Mail.gs`
   - `CreateQuoteDialog.html`
   - （その他のHTMLファイル）

3. プロジェクトを保存

### 4. 初回設定

1. スプレッドシートをリロード
2. カスタムメニュー「📄 請求書管理」が表示される
3. 「設定」シートに自社情報を入力
4. 「取引先を追加」で顧客情報を登録

### 5. PDF生成の設定（任意）

1. Google Docsで請求書テンプレートを作成
2. テンプレート内に以下の変数を配置（例）：
   ```
   {{書類種別}}
   {{書類番号}}
   {{発行日}}
   {{取引先名}}
   {{件名}}
   {{明細}}
   {{合計金額}}
   ...
   ```
3. テンプレートIDを取得して`PDF.gs`の`TEMPLATE_IDS`に設定

## 使い方

### 見積書を作成

1. メニュー「見積書作成」をクリック
2. 取引先、発行日、件名、明細を入力
3. 「見積書を作成」ボタン → 見積書シートに追加

### 見積書 → 請求書に変換

1. メニュー「見積書 → 請求書に変換」をクリック
2. 見積書番号を選択
3. 支払期限を入力
4. 「変換」ボタン → 請求書シートに追加

### 合算請求書を作成

1. メニュー「合算請求書を作成」をクリック
2. 取引先を選択
3. 合算する見積書・納品書を選択
4. 「合算請求書を作成」ボタン → 1つの請求書にまとめる

### メール送信（Gmail連携）

※ 実装完了後に追記

## ディレクトリ構成

```
gas/
├── Code.gs                 # メイン処理
├── Utils.gs                # ユーティリティ関数
├── Quote.gs                # 見積書処理
├── Delivery.gs             # 納品書処理
├── Invoice.gs              # 請求書処理
├── Receipt.gs              # 領収書処理
├── Conversion.gs           # 書類変換処理
├── Customer.gs             # 取引先管理
├── CombineInvoice.gs       # 合算請求書
├── PDF.gs                  # PDF生成処理
├── Mail.gs                 # メール送信処理
├── CreateQuoteDialog.html  # 見積書作成UI
└── README.md               # このファイル
```

## GASの制限事項

- **実行時間上限**: 6分/実行
- **トリガー実行時間**: 90分/日（無料アカウント）
- **メール送信**: 100通/日（無料）、1,500通/日（Google Workspace）
- **推奨利用規模**: 月間100件以下の書類発行

## ライセンス

MIT License

## サポート

ご質問・カスタマイズ依頼は以下までお問い合わせください：
- Email: info@yojitu.com
- Web: https://www.yojitu.com
